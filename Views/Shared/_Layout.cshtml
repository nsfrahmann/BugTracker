@using Microsoft.AspNetCore.Identity
@using BugTracker.Services
@inject UserManager<BTUser> UserManager
@inject IBTNotificationsService _notificationsService
@inject IBTTicketsService _ticketsService
@inject IBTProjectsService _projectsService
@inject IBTRolesService _rolesService
@inject IBTAttachmentsService _attachmentsService

@{
    List<Notification> notificationList = await _notificationsService.NotificationList();
    var notifications = _notificationsService.UserNotifications();
    var user = await UserManager.GetUserAsync(User);
    var ticket = _ticketsService.Ticket();
    var project = _projectsService.Project();
    var roles = _rolesService.RoleSelect();
    var users = await _rolesService.MultiUsersSelect();

}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] BeeKeep</title>
    <link rel="shortcut icon" href="~/img/BeeNoWing.ico" />

    <link href="~/css/BeeDash.css" rel="stylesheet" />
    <link href="~/css/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/css/main.css" rel="stylesheet" />
    <link href="~/css/simple-line-icons.css" rel="stylesheet" />
    <link href="~/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
    <link href="~/css/toastr.min.css" rel="stylesheet" />
    <link href="~/css/buttons.bootstrap4.min.css" rel="stylesheet" />
    <link href="~/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css" rel="stylesheet" />
    <link href="https://unpkg.com/filepond/dist/filepond.min.css" rel="stylesheet" />
    <link href="~/css/select2.min.css" rel="stylesheet" />
    <link href="~/css/select2-bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet" />


    @RenderSection("css", required: false)

    <style>
        ::-webkit-scrollbar {
            height: .3em;
            width: .3em;
        }

        body::-webkit-scrollbar {
            width: .3em;
            height: .3em;
        }

        ::-webkit-scrollbar-track {
            box-shadow: inset 0 0 6px rgba(0, 0, 0);
            background-color: #000
        }

        body::-webkit-scrollbar-track {
            box-shadow: inset 0 0 6px rgba(0, 0, 0);
            background-color: #000
        }

        ::-webkit-scrollbar-thumb {
            background-color: gold;
            outline: 0;
            border-radius: 5em;
        }

        body::-webkit-scrollbar-thumb {
            background-color: gold;
            outline: 0;
            border-radius: 5em;
        }

        a {
            color: white;
        }

            a:hover {
                color: gold;
                text-decoration: none;
            }

            a:link {
                text-decoration: none;
            }


            a:visited {
                text-decoration: none;
            }


            a:active {
                text-decoration: none;
            }

        .btn-secondary {
            background-color: #000;
            color: #fff;
            border: 1px solid rgba(255,215,0,.5);
        }

            .btn-secondary:active, .btn-secondary:focus {
                background-color: #000 !important;
                color: rgba(255,215,0,.9) !important;
                border: 1px solid rgba(255,215,0,.5) !important;
                outline: none !important;
                box-shadow: none !important;
            }

            .btn-secondary:hover {
                background-color: #000;
                color: rgba(255,215,0,.9);
                border: 1px solid rgba(255,215,0,.5);
            }

        .table-dark {
            background-color: #101414;
        }

            .table-dark td, .table-dark th.sorting, .table-dark th.sorting_asc, .table-dark th.sorting_desc {
                border-color: rgba(255,215,0,.2);
                border-bottom: none;
                border-top: none;
            }

            .table-dark th.sorting, .table-dark th.sorting_asc {
                color: rgba(255,215,0,.85);
            }

        .table {
            border-radius: 1rem;
            box-shadow: 0px 0px 3px 3px rgba(0,0,0,.8);
            font-size: .9rem;
        }

        .toast {
            background-color: gold !important;
            max-width: 400px !important;
            text-align: center !important;
        }

        .toast-message {
            font-size: 1rem !important;
            font-weight: 700 !important;
        }

        .toast-warning {
            background-size: 30px !important;
        }

        .toast-close-button {
            z-index: 9999;
        }

            .toast-close-button:hover {
                transform: scale(1.8)
            }

            .toast-close-button:active, .toast-close-button:focus {
                text-decoration: none !important;
                border: none !important;
                outline: none !important;
                transform: scale(1.3)
            }

        #toast-container {
            max-height: 253px !important;
            overflow: hidden !important;
        }

        div.tox-toolbar {
            background-color: #1c2020 !important;
        }

        div.tox-editor-header {
            background-color: #1c2020 !important;
            border-bottom: none !important;
        }

        div.tox.tox-tinymce {
            border: none !important;
        }

        .tox-edit-area__iframe {
            background: none !important;
        }

        .tox-statusbar {
            display: none !important;
        }

        .modal-body {
            border-top: 1px solid rgba(255,215,0,.2) !important;
        }

        .text-primary {
            color: gold !important;
        }

        .page-link:hover, .page-link:focus {
            background-color: #000;
            border: 1px solid gold !important;
        }

        a[aria-controls="example"] {
            color: #fff !important;
            border: 1px solid rgba(255,215,0,.5) !important;
        }

        input.textButton:hover, input.textButton:focus {
            color: gold !important;
            background-color: #000 !important;
        }

        a.my-reply {
            color: #007bff !important;
        }

            a.my-reply:hover, a.my-reply:focus {
                color: #fff !important;
            }

        .moveContent {
            width: 100vw !important;
            margin-left: 0px !important;
        }

        .custom-file-upload-hidden {
            display: none;
            visibility: hidden;
            position: absolute;
            left: -9999px;
        }

        .custom-file-upload {
            display: block;
            width: auto;
            font-size: 16px;
            margin-top: 30px;
        }

            .custom-file-upload label {
                display: block;
                margin-bottom: 5px;
            }

        .file-upload-wrapper {
            position: relative;
        }

        .file-upload-input {
            width: 350px;
            color: #fff;
            font-size: 16px;
            padding: 11px 17px;
            border: none;
            background-color: #fff;
            border-radius: .7rem 0 0 .7rem;
            /* IE 9 Fix */
        }

            .file-upload-input:hover, .file-upload-input:focus {
                outline: none;
            }

        .file-upload-button {
            cursor: pointer;
            display: inline-block;
            color: #fff;
            font-size: 16px;
            text-transform: uppercase;
            padding: 11px 20px;
            border: none;
            margin-left: -1px;
            background-color: #ccac00;
            border-radius: 0 .7rem .7rem 0;
            /* IE 9 Fix */
        }

            .file-upload-button:hover {
                background-color: #998100;
            }
            div.tox-notifications-container {
                display: none !important;
            }
        img.avatar {
            -moz-border-radius: 50px/50px;
            -webkit-border-radius: 50px 50px;
            border-radius: 50px/50px;
            width: 50px;
            height: 50px;
        }
    </style>

</head>
<body>

    <section id="main-container" class="default" style="background-color: #191f1f; height: 100%; min-height: 100vh; overflow-x: hidden;">
        <!-- START: Pre Loader-->
        <!-- END: Pre Loader-->
        <!-- START: Header-->
        <div id="header-fix" class="header fixed-top" style="background-color: #ffffed">
            <div class="site-width">
                <nav class="navbar navbar-expand-lg  p-0">
                    <div class="navbar-header h-100 h4 mb-0 align-self-center logo-bar text-left" style="background-color: #ffffed">
                        <a asp-controller="Dashboard" asp-action="Home" class="horizontal-logo text-left">
                            <img src="~/img/BeeFavicon.svg" class="navLogo" />
                        </a>
                        <div id="logoText" class="mt-1" style="margin-left: 80px">
                            <span>BeeKeep</span>
                        </div>
                    </div>

                    <div class="navbar-right ml-auto h-100">
                        @*<div class="h4 mb-0 text-center h-100 collapse-menu-bar">
                                <a href="#" class="sidebarCollapse" id="collapse"><i class="icon-menu"></i></a>
                            </div>*@
                        <ul class="ml-auto p-0 m-0 list-unstyled d-flex top-icon h-100">
                            <li class="align-self-center collapse-menu-bar d-inline-block">
                                <a class="sidebarExpand d-none" id="expand" style="cursor:pointer"><i class="icon-menu"></i></a>
                                <a class="sidebarCollapse" id="collapse" style="cursor:pointer"><i class="icon-menu"></i></a>
                            </li>
                            <li class="dropdown align-self-center d-inline-block">
                                <a href="#" class="nav-link" data-toggle="dropdown" aria-expanded="false">
                                    <i class="icon-bell h4"></i>
                                    <span class="badge badge-default">
                                        @if (notifications.Count > 0)
                                        {
                                            <span class="ring">
                                            </span><span class="ring-point">
                                            </span>
                                        }
                                    </span>
                                </a>
                                @if (notifications.Count > 0)
                                {
                                    <ul class="dropdown-menu dropdown-menu-right border py-0" style="max-height: 300px; overflow-y: scroll">

                                        @foreach (var notification in notificationList)
                                        {
                                            var timePassed = (DateTime.Now - notification.Created);
                                            <li>
                                                <a href="/Tickets/Details/@notification.TicketId?click=true&tikId=@notification.TicketId" class="dropdown-item px-2 py-2 border border-top-0 border-left-0 border-right-0">
                                                    <div class="media">
                                                        <img src="dist/images/author.jpg" alt="" class="d-flex mr-3 img-fluid rounded-circle w-50">
                                                        <div class="media-body">
                                                            <p class="mb-0 text-success" style="font-size: 1rem; font-weight: 600">@notification.Ticket.Title</p>
                                                            <p class="mb-0 text-success">@notification.Description</p>
                                                            @if (timePassed.TotalDays > 1)
                                                            {
                                                                <span>@timePassed.ToString("dd") days ago</span>
                                                            }
                                                            else if (timePassed.TotalHours > 1)
                                                            {
                                                                <span>@timePassed.ToString("HH") hours ago</span>
                                                            }
                                                            else
                                                            {
                                                                <span>@timePassed.ToString("mm") minutes ago</span>
                                                            }

                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                        }

                                        @*<li><a asp-controller="Tickets" asp-action="NotificationDelete" method="post"> Clear All <i class="icon-arrow-right pl-2 small"></i></a></li>*@
                                    </ul>
                                }

                            </li>
                            <li class="dropdown user-profile align-self-center d-inline-block">
                                <a href="" class="nav-link py-0" data-toggle="dropdown" aria-expanded="false">
                                    <div class="media">
                                        @if (user.AvatarData != null)
                                        {
                                            var avatar = _attachmentsService.DecodeAttachment(user.AvatarData, user.AvatarName);
                                            <img src="@avatar" class="img-fluid avatar" style="object-fit: cover; box-shadow: 0px 0px 7px 0px rgba(0,0,0,.8); margin-top: -10px" />
                                        }
                                        else
                                        {
                                            <img width="50" src="~/img/beekeeper.jpg" class="img-fluid rounded-circle" style="box-shadow: 0px 0px 7px 0px rgba(0,0,0,.8); margin-top: -10px" />
                                        }
                                    </div>
                                </a>

                                <div class="dropdown-menu border dropdown-menu-right p-0">
                                    <a asp-controller="Users" asp-action="Profile" class="dropdown-item px-2 align-self-center d-flex">
                                        <span class="icon-user mr-2 h6 mb-0"></span> View Profile
                                    </a>
                                    @*<div class="dropdown-divider"></div>
                                        <a href="" class="dropdown-item px-2 align-self-center d-flex">
                                            <span class="icon-support mr-2 h6  mb-0"></span> Help Center
                                        </a>
                                        <a href="" class="dropdown-item px-2 align-self-center d-flex">
                                            <span class="icon-globe mr-2 h6 mb-0"></span> Forum
                                        </a>
                                        <a href="" class="dropdown-item px-2 align-self-center d-flex">
                                            <span class="icon-settings mr-2 h6 mb-0"></span> Account Settings
                                        </a>*@
                                    <div class="dropdown-divider"></div>
                                    <a href="" class="dropdown-item px-2 text-danger align-self-center d-flex">
                                        <span class="icon-logout mr-2 h6  mb-0"></span>
                                        <form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                                            <button class="textButton" type="submit">Logout</button>
                                        </form>
                                    </a>
                                </div>

                            </li>

                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <!-- END: Header-->
        @*Tickets Create Modal*@
        <div class="modal fade" id="createTicketModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div class="modal-content" style="background-color:#1c2020">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel" style="color:gold">Create New Ticket</h5>
                        <button type="button" style="color:gold" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="overflow: scroll;">
                        <div class="col" style="width:100%">
                            <form asp-controller="Tickets" asp-action="Create" id="testform" enctype="multipart/form-data">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                @if (ticket.ProjectId != 0)
                                {
                                    <input type="hidden" asp-for="@ticket.ProjectId" />
                                }
                                else
                                {
                                    <div class="form-group">
                                        <label class="control-label text-white">Parent Project</label>
                                        <select asp-for="@ticket.ProjectId" class="form-control" asp-items="_ticketsService.GetProjectSelect()"></select>
                                    </div>
                                }
                                <div class="form-group">
                                    <label class="control-label text-white">Ticket Type</label>
                                    <select asp-for="@ticket.TicketTypeId" class="form-control" asp-items="_ticketsService.GetTicketTypeSelect()"></select>
                                </div>
                                <div class="form-group">
                                    <label class="control-label text-white">Title</label>
                                    <input asp-for="@ticket.Title" class="form-control" />
                                    <span asp-validation-for="@ticket.Title" class="text-danger"></span>
                                </div>
                                <div class="form-group">
                                    <label class="control-label text-white">Description</label>
                                    <input asp-for="@ticket.Description" class="form-control" />
                                    <span asp-validation-for="@ticket.Description" class="text-danger"></span>
                                </div>
                                <div class="custom-file-upload" style="margin-top: -5px">
                                    <label class="control-label text-white">Attachments<span class="text-muted"> (3 max)</span></label>
                                    <input type="file" id="file" name="FormFile" multiple />
                                </div>
                                @*<div class="form-group">
                                            <label asp-for="@ticket.PriorityId" class="control-label"></label>
                                            <select asp-for="@ticket.PriorityId" class="form-control" asp-items="ViewBag.TicketPriorityId"></select>
                                    </div>
                                    <div class="form-group">
                                            <label asp-for="@ticket.StatusId" class="control-label"></label>
                                            <select asp-for="@ticket.StatusId" class="form-control" asp-items="ViewBag.TicketStatusId"></select>
                                    </div>*@
                                <div class="form-group mt-3">
                                    <input type="submit" value="Create" class="btn btn-secondary" />
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @*Projects Create Modal*@
        <div class="modal fade" id="createProjectModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div class="modal-content" style="background-color:#1c2020">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel" style="color:gold">Create New Project</h5>
                        <button type="button" style="color:gold" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="overflow: scroll;">
                        <div class="col" style="width:100%">
                            <form asp-controller="Projects" asp-action="Create">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                <div class="form-group">
                                    <label class="control-label text-white">Title</label>
                                    <input asp-for="@project.Name" class="form-control" />
                                    <span asp-validation-for="@project.Name" class="text-danger"></span>
                                </div>
                                <div class="form-group">
                                    <label class="control-label text-white">Summary</label>
                                    <input asp-for="@project.Summary" class="form-control" />
                                    <span asp-validation-for="@project.Summary" class="text-danger"></span>
                                </div>
                                <div class="form-group">
                                    <input type="submit" value="Create" class="btn btn-secondary" />
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="assignRolesModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div class="modal-content" style="background-color:#1c2020">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel" style="color:gold">Manage User Roles</h5>
                        <button type="button" style="color:gold" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="overflow: scroll;">
                        <div class="col" style="width:100%">
                            <form asp-controller="Users" asp-action="AssignRole">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                <div class="form-group">
                                    <label class="control-label text-white">Users to be Assigned</label>
                                    <select name="UsersSelected" asp-items="users" multiple data-allow-clear="1" class="form-control select2"></select>
                                </div>
                                <div class="form-group">
                                    <label class="control-label text-white">Roles</label>
                                    <select name="RoleSelected" asp-items="roles" class="form-control"></select>
                                </div>
                                <div class="form-group">
                                    <input type="submit" value="Create" class="btn btn-secondary" />
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- START: Main Menu-->
        <div class="sidebar min-vh-100" id="sidebar">
            <div class="site-width" style="background-color: #ffffed;">

                <!-- START: Menu-->
                <ul id="side-menu" class="sidebar-menu min-vh-100" style="overflow: hidden;">
                    <li class="dropdown">
                        <a href="#" style="background-color: #232b2b"><i class="icon-home mr-1"></i> Dashboard</a>
                        <ul>
                            <li><a asp-controller="Dashboard" asp-action="Home"><i class="icon-loop"></i> Home</a></li>
                            <li><a asp-controller="Users" asp-action="Profile"><i class="icon-user"></i> Profile</a></li>
                            @*<li><a href="form-icheck.html"><i class="icon-briefcase"></i> Settings</a></li>*@
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" style="background-color: #232b2b"><i class="icon-folder-alt mr-1"></i> Projects</a>
                        <ul>
                            <li><a asp-controller="Projects" asp-action="Index"><i class="icon-docs"></i> All</a></li>
                            @*<li><a href="index-account.html"><i class="icon-layers"></i> Project Assignments</a></li>
                                <li><a href="index-analytic.html"><i class="icon-grid"></i> My Creates</a></li>*@
                            <li><a asp-controller="Projects" asp-action="Create" data-toggle="modal" data-target="#createProjectModal"><i class="icon-note"></i> Create New</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" style="background-color: #232b2b"><i class="icon-tag mr-1"></i> Tickets</a>
                        <ul>
                            <li><a asp-controller="Tickets" asp-action="Index"><i class="icon-docs"></i> All</a></li>
                            @*<li><a href="app-filemanager.html"><i class="icon-folder"></i> Ticket Assignments</a></li>
                                <li><a href="app-mail.html"><i class="icon-envelope"></i> My Submits</a></li>*@
                            <li><a asp-controller="Tickets" asp-action="Analytics"><i class="icon-pie-chart"></i> Analytics</a></li>
                            <li><a asp-controller="Tickets" asp-action="Create" data-toggle="modal" data-target="#createTicketModal"><i class="icon-note"></i> Create New</a></li>
                        </ul>

                    </li>
                    <li class="dropdown">
                        <a href="#" style="background-color: #232b2b"><i class="icon-graduation mr-1"></i> Assignment</a>
                        <ul>
                            @*<li><a><i class="icon-support"></i> Assign To Project</a></li>
                                <li><a><i class="icon-people"></i> Assign To Ticket</a></li>*@
                            <li><a asp-controller="UserRoles" asp-action="Assign" data-toggle="modal" data-target="#assignRolesModal"><i class="icon-shuffle"></i> Role Manager</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <!-- END: Main Menu-->
        <!-- START: Main Content-->
        <main class="wrapper text-white" id="pagecontent">
            <div class="m-5">
                @RenderBody()
            </div>
            <div class="push"></div>
        </main>
        <footer class="site-footer footer pt-3" id="pagefooter" style="background-color: #ffffed;">
            2020 © BeeKeep
        </footer>
    </section>
    <form id="logout-form" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })"></form>

    <script src="~/js/jquery-3.3.1.min.js"></script>
    <script src="~/js/jquery-ui.min.js"></script>
    <script src="~/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/jquery.slimscroll.min.js"></script>
    <script src="~/js/jquery.dataTables.min.js"></script>
    <script src="~/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/js/jszip.min.js"></script>
    <script src="~/js/pdfmake.min.js"></script>
    <script src="~/js/vfs_fonts.js"></script>
    <script src="~/js/dataTables.buttons.min.js"></script>
    <script src="~/js/buttons.bootstrap4.min.js"></script>
    <script src="~/js/buttons.colVis.min.js"></script>
    <script src="~/js/buttons.flash.min.js"></script>
    <script src="~/js/buttons.html5.min.js"></script>
    <script src="~/js/buttons.print.min.js"></script>
    <script src="~/js/datatable1.script.js"></script>
    <script src="~/js/datatable.script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="~/js/toastr.min.js"></script>
    <script src="~/js/toastr.script.js"></script>
    <script src="https://cdn.tiny.cloud/1/ll8zhakbba1xr0km3e379sdk1lgtrjbl3cltdf4o4gen6z6n/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    <script src="~/js/select2.full.min.js"></script>
    <script src="~/js/select2.script.js"></script>

    <script>

        setTimeout(function () { document.getElementById('logout-form').submit() }, 1000 * 60 * 30)

        $(function () {
            $('[data-toggle="popover"]').popover()
        })

        tinymce.init({
            selector: '.tiny',
            min_height: 200,
            skin: 'oxide-dark',
            content_style: "body { color: white; border-bottom: 1px solid rgba(255,215,0,.2); }",
            plugins: 'lists codesample autoresize link',
            menubar: false,
            toolbar: [
                'undo redo | styleselect fontsizeselect | bold italic underline strikethrough numlist bullist | link codesample | alignleft aligncenter alignright alignjustify | outdent indent'
            ],
            default_link_target: '_blank',
            codesample_global_prismjs: true,
            branding: false,
            elementpath: false
        });
    </script>
    <script>
        $('#collapse').on('click', function () {
            $('#sidebar').addClass('animate__animated animate__slideOutLeft');
            $('#collapse').addClass('d-none');
            $('#expand').removeClass('d-none');
            setTimeout(function () {
                $('#pagecontent').addClass('moveContent');
                $('#pagefooter').addClass('moveContent');
            }, 450);
        })

        $('#expand').on('click', function () {
            $('#sidebar').removeClass('animate__animated animate__slideOutLeft').addClass('animate__animated animate__slideInLeft');
            $('#expand').addClass('d-none');
            $('#collapse').removeClass('d-none');
            setTimeout(function () {
                $('#pagecontent').removeClass('moveContent');
                $('#pagefooter').removeClass('moveContent');
            }, 300);
        })

    </script>

    <script>
        ; (function ($) {

            // Browser supports HTML5 multiple file?
            var multipleSupport = typeof $('<input/>')[0].multiple !== 'undefined',
                isIE = /msie/i.test(navigator.userAgent);

            $.fn.customFile = function () {

                return this.each(function () {

                    var $file = $(this).addClass('custom-file-upload-hidden'), // the original file input
                        $wrap = $('<div class="file-upload-wrapper">'),
                        $input = $('<input type="text" class="file-upload-input" />'),
                        // Button that will be used in non-IE browsers
                        $button = $('<button type="button" class="file-upload-button">Select Your Files</button>'),
                        // Hack for IE
                        $label = $('<label class="file-upload-button" for="' + $file[0].id + '">Select a File</label>');

                    // Hide by shifting to the left so we
                    // can still trigger events
                    $file.css({
                        position: 'absolute',
                        left: '-9999px'
                    });

                    $wrap.insertAfter($file)
                        .append($file, $input, (isIE ? $label : $button));

                    // Prevent focus
                    $file.attr('tabIndex', -1);
                    $button.attr('tabIndex', -1);

                    $button.click(function () {
                        $file.focus().click(); // Open dialog
                    });

                    $file.change(function () {

                        var files = [], fileArr, filename;

                        // If multiple is supported then extract
                        // all filenames from the file array
                        if (multipleSupport) {
                            fileArr = $file[0].files;
                            for (var i = 0, len = fileArr.length; i < len; i++) {
                                files.push(fileArr[i].name);
                            }
                            filename = files.join(', ');

                            // If not supported then just take the value
                            // and remove the path to just show the filename
                        } else {
                            filename = $file.val().split('\\').pop();
                        }

                        $input.val(filename) // Set the value
                            .attr('title', filename) // Show filename in title tootlip
                            .attr('style', 'color: black')
                            .focus(); // Regain focus

                    });

                    $input.on({
                        blur: function () { $file.trigger('blur'); },
                        keydown: function (e) {
                            if (e.which === 13) { // Enter
                                if (!isIE) { $file.trigger('click'); }
                            } else if (e.which === 8 || e.which === 46) { // Backspace & Del
                                // On some browsers the value is read-only
                                // with this trick we remove the old input and add
                                // a clean clone with all the original events attached
                                $file.replaceWith($file = $file.clone(true));
                                $file.trigger('change');
                                $input.val('');
                            } else if (e.which === 9) { // TAB
                                return;
                            } else { // All other keys
                                return false;
                            }
                        }
                    });

                });

            };

            // Old browser fallback
            if (!multipleSupport) {
                $(document).on('change', 'input.customfile', function () {

                    var $this = $(this),
                        // Create a unique ID so we
                        // can attach the label to the input
                        uniqId = 'customfile_' + (new Date()).getTime(),
                        $wrap = $this.parent(),

                        // Filter empty input
                        $inputs = $wrap.siblings().find('.file-upload-input')
                            .filter(function () { return !this.value }),

                        $file = $('<input type="file" id="' + uniqId + '" name="' + $this.attr('name') + '"/>');

                    // 1ms timeout so it runs after all other events
                    // that modify the value have triggered
                    setTimeout(function () {
                        // Add a new input
                        if ($this.val()) {
                            // Check for empty fields to prevent
                            // creating new inputs when changing files
                            if (!$inputs.length) {
                                $wrap.after($file);
                                $file.customFile();
                            }
                            // Remove and reorganize inputs
                        } else {
                            $inputs.parent().remove();
                            // Move the input so it's always last on the list
                            $wrap.appendTo($wrap.parent());
                            $wrap.find('input').focus();
                        }
                    }, 1);

                });
            }

        }(jQuery));

    $('input[type=file]').customFile();
    </script>

    @if (TempData["DemoLockout"] != null)
    {
        <script>
            function () {
                alert("@TempData["DemoLockout"]");
            }
        </script>
    }
    <!-- END: Template JS-->
    <!-- START: APP JS-->
    @RenderSection("Scripts", required: false)
</body>
</html>